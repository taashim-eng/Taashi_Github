# Facebook: Real-Time Viral Content Detection

## 1. Problem Statement
With billions of posts daily, Facebook needs to instantly identify 'Viral' content to push it to users' News Feeds. Waiting for batch processing means missing the trend. We need a real-time stream processor to calculate 'Reaction Velocity'.

## 2. Requirements & KPIs
- Ingestion: Handle bursty traffic (e.g., Live Events, Breaking News).
- Velocity Tracking: Calculate interactions per second for every Post ID.
- Thresholding: If velocity > 100/sec, flag as 'Viral'.
- Reaction Types: Distinguish between 'Like' (Positive) and 'Angry' (Controversial).

## 3. Architecture & Pipeline
1. **Interaction Stream (Producer)**: Simulates user reactions (Like, Love, Angry).
2. **Ingest**: Kafka Topic `fb-interactions`.
3. **Velocity Engine (Consumer)**: 
   - Aggregates reactions in 2-second windows.
   - Flags posts exceeding the 'Viral Threshold'.
4. **Action**: Updates the Global Feed algorithm instantly.

---

## 4. Technical Implementation

### File Structure
- `producer.py`: Generates a high-velocity stream of Likes/Reactions.
- `consumer.py`: The Viral Engine. Detects spikes in post traffic.
- `utils_logger.py`: Logging config.

### Architecture Diagram: Facebook Viral Content Detection

```mermaid
graph TD
  %% Definitions & Styling
  classDef source fill:#E1D5E7,stroke:#9673A6,stroke-width:2px,color:#000;
  classDef ingestion fill:#FFF2CC,stroke:#D6B656,stroke-width:2px,color:#000;
  classDef processing fill:#DAE8FC,stroke:#6C8EBF,stroke-width:2px,color:#000;
  classDef action fill:#D5E8D4,stroke:#82B366,stroke-width:2px,color:#000;
  classDef storage fill:#F5F5F5,stroke:#666666,stroke-width:2px,color:#000;

  subgraph Sources ["User Interactions"]
    Mobile["Mobile App Users
(Likes, Comments)"]:::source
    Web["Web Desktop Users
(Reactions, Shares)"]:::source
  end

  subgraph Ingestion ["High Velocity Ingest"]
    Kafka["Kafka Topic
(fb-interactions)"]:::ingestion
  end

  subgraph Processing ["Viral Engine (Consumer)"]
    VelocityEngine["Stream Processor
(Calculate Velocity/Sec)"]:::processing
    ThresholdLogic{"Velocity > 100?"}:::processing
  end

  subgraph State ["State Management"]
    Redis[("Redis Counter
(Sliding Window State)")]:::storage
  end

  subgraph Actions ["Downstream Impact"]
    NewsFeed["News Feed Algorithm
(Boost Visibility)"]:::action
    Analytics["Content Dashboard
(Trending Topics)"]:::action
  end

  %% Data Flow
  Mobile -->|"Emit Interaction"| Kafka
  Web -->|"Emit Interaction"| Kafka
  Kafka -->|"Consume Stream"| VelocityEngine
  
  VelocityEngine -->|"Update Count"| Redis
  Redis -.->|"Return Current Velocity"| VelocityEngine
  
  VelocityEngine -->|"Check Threshold"| ThresholdLogic

  %% Logic Flow
  ThresholdLogic -->|"Yes (Viral)"| NewsFeed
  ThresholdLogic -->|"Yes (Viral)"| Analytics
  ThresholdLogic -->|"No (Normal)"| Redis

  linkStyle 2,3,4,5,6 stroke:#007ACC,stroke-width:2px,fill:none;
```


### How to Run this Demo

**Step 1: Install Dependencies**
```bash
pip install -r requirements.txt
```

**Step 2: Start the Viral Engine (Consumer)**
This service monitors the stream for trends.
```bash
python consumer.py
```
*It will start listening for engagement spikes...*

**Step 3: Start the Traffic Generator (Producer)**
This simulates millions of users clicking 'Like'.
```bash
python producer.py
```

**Step 4: Observe Trends**
Watch the Consumer terminal. You will see:
- ðŸ“ˆ **Rising**: A post is gaining traction.
- ðŸš€ **VIRAL TREND DETECTED**: A post has exploded in popularity.

---
*Generated by Automation Script | Facebook: Real-Time Viral Content Detection Project*
